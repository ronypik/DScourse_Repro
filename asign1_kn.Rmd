---
title: "Reproducible Research/ Peer Assessment 1"
output: html_document
---


###Loading and preprocessing the data###



```{r,, echo=TRUE}
activity <- read.csv("E:/WORKS/R/Repr/activity.csv")
str(activity)
```

Calculate the total number of steps taken per day

```{r, echo=TRUE}
steps_by_day <- aggregate(activity$steps, by=list(activity$date), FUN=sum)
colnames(steps_by_day) <- c("Date","Steps")
```
### A histogram of the total number of steps taken each day ###

```{r fig.width=4, fig.height=4}
library(ggplot2)
ggplot(steps_by_day, aes(x=Steps)) + geom_histogram(binwidth=5000, colour="black", fill="white")
```

### Mean and median of the total number of steps taken per day ###

```{r, echo=TRUE}
steps_mean <-   as.factor(mean(x=steps_by_day$Steps,na.rm = TRUE))
steps_median <- as.factor(median(x=steps_by_day$Steps,na.rm = TRUE))
```
Steps mean of steps taken per date is **`r steps_mean`**.

Steps median of steps taken per date is **`r steps_median`**.



### The average daily activity pattern ###

Calculate the total number of steps taken per interval

```{r, echo=TRUE}
steps_by_interval <- aggregate(activity$steps, by=list(activity$interval), FUN=mean, na.rm = T)
colnames(steps_by_interval) <- c("Interval","Avg_Steps")
str(steps_by_interval)
```



Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r, echo=TRUE}
max_steps_int <- steps_by_interval[which.max(steps_by_interval$Avg_Steps), ]$Interval
```

The 5-minute interval with maximum number of steps is **`r max_steps_int`**.


We will make a time series plot of the 5-minute interval (x-axis) and 
the average number of steps taken, averaged across all days (y-axis)

```{r fig.width=4, fig.height=4}
ggplot(steps_by_interval, aes(x=Interval, y=Avg_Steps)) + geom_line()+
geom_vline(xintercept = max_steps_int, colour="red", linetype = "longdash")+
  xlab("Interval") +ylab("Average Steps") +  
  annotate("text", x = max_steps_int-120, y = 0, label = max_steps_int,colour = "red")
```
Note: in RED is 5-minute interval with maximum number of steps.


### Imputing missing values ###

Calculate and report the total number of missing values in the dataset 

```{r, echo=TRUE}
summary(activity$steps)
str(activity$steps)
```

We will use mean value to filling in all of the missing values in the dataset. 

```{r, echo=TRUE}
mean_steps <- mean(activity$steps, na.rm=T)
activity$steps <- ifelse(is.na(activity$steps),mean_steps,activity$steps)
summary(activity$steps)
str(activity$steps)
```



### A histogram of the total number of steps taken each day ###

Calculate the total number of steps taken per day

```{r, echo=TRUE}
steps_by_day <- aggregate(activity$steps, by=list(activity$date), FUN=sum)
colnames(steps_by_day) <- c("Date","Steps")
```

```{r fig.width=4, fig.height=4}
library(ggplot2)
ggplot(steps_by_day, aes(x=Steps)) + geom_histogram(binwidth=5000, colour="black", fill="white")
```


### Mean and median of the total number of steps taken per day ###

```{r, echo=TRUE}
steps_mean <-   as.factor(mean(x=steps_by_day$Steps,na.rm = TRUE))
steps_median <- as.factor(median(x=steps_by_day$Steps,na.rm = TRUE))
```
Steps mean of steps taken per date is **`r steps_mean`**.

Steps median of steps taken per date is **`r steps_median`**.


1. Do these values differ from the estimates from the first part of the assignment? 
The mean remains the same but the median increased. 

2. What is the impact of imputing missing data on the estimates of the total 
daily number of steps?
The total daily number of steps is increased after inputting missing data.



### The differences in activity patterns between weekdays and weekends ###

We will Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.

```{r, echo=TRUE}
Sys.setlocale("LC_TIME", "English")
activity$Date_IND <- as.factor(ifelse(weekdays(as.Date(activity$date, format = "%Y-%m-%d")) %in%  c("Saturday","Sunday"), "Weekend", "Weekday"))
str(activity)
```


Calculate the total number of steps taken per day

```{r, echo=TRUE}
steps_by_interval_DAY <- aggregate(activity$steps, by=list(activity$interval,activity$Date_IND), FUN=mean, na.rm = T)
colnames(steps_by_interval_DAY) <- c("Interval","DAY_IND","Avg_Steps")
str(steps_by_interval_DAY)
```

A panel plot containing a time series plot of the 5-minute interval 
(x-axis) and the average number of steps taken, averaged across all weekday days
or weekend days (y-axis). 


```{r fig.width=8, fig.height=4}
ggplot(steps_by_interval_DAY, aes(x=Interval, y=Avg_Steps)) + geom_line()+
  facet_wrap(~DAY_IND)+
  xlab("Interval") +ylab("Average Steps") 
```







